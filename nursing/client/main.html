<template name="navigation">
	<nav class="navbar navbar-inverse navbar-fixed-top">
		<div class="navbar-inner">
			<div class="container-fluid">
				<button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<div class="nav-collapse collapse">
					<ul class="nav">
						<li id="home-navigation" class="{{ activeIfTemplateIs 'Home' }}">
							<a href="{{pathFor 'home'}}"><i class="fa fa-fw fa-table"></i> {{language.home}}</a>
						</li>
						<li id="home-navigation" class="{{ activeIfTemplateIs 'Reminders' }}">
							<a href="{{pathFor 'reminders'}}"><i class="fa fa-fw fa-warning"></i> {{language.reminders}}&nbsp;&nbsp;<span class="badge alert-danger">{{deadlineReminders}}</span></a>
						</li>
						<li id="home-navigation" class="{{ activeIfTemplateIs 'Journal' }}">
							<a href="{{pathFor 'journal'}}"><i class="fa fa-fw fa-envelope"></i> {{language.journal}}&nbsp;&nbsp;<span class="badge alert-info">{{unreadMessages}}</span></a>
						</li>
						<li id="rooms-navigation" class="{{ activeIfTemplateIs 'Measures' }}">
							<a href="{{pathFor 'measures'}}"><i class="fa fa-fw fa-table"></i> {{language.measures}}<!--&nbsp;&nbsp;<span class="badge alert-info">{{language.}}</span>--></a>
						</li>
						<li>
							<a href="#" id="logout-toggle"><i class="fa fa-sign-out"></i> {{language.signout}}</a>
						</li>
					</ul>
				</div>
			</div>
		</div>
	</nav>
</template>

<template name="footer">
	<div id="footer" class="container">
		<nav class="navbar navbar-default navbar-fixed-bottom">
			<div class="navbar-inner navbar-content-center">
				<div class="span2 offset5">
					<p class="navbar-text" style="text-align: center;">
						{{#if nameSelected}}
						<div class="pointer">
							<h4>{{patientName}} <i class="fa fa-times-circle-o alizarin"></i></h4>
						</div>
						{{else}}
						{{> inputAutocomplete settings=settings type="text" class="search-query" placeholder="Patient"}}
						{{/if}}
					</p>
				</div>
				<div class="btn-group dropup plusButton">
					<button class="btn dropdown-toggle" style="	width: 100px;" data-toggle="dropdown">
						<i class="fa fa-plus"></i>
					</button>
					<ul class="dropdown-menu pull-right">
						{{#if nameSelected}}
						<li>
							<a href="#" data-toggle="modal" data-target="#measurement"><i class="fa fa-sliders"></i> New Measurement</a>
						</li>
						<li>
							<a href="#" data-toggle="modal" data-target="#alert"><i class="fa fa-bell"></i> New Alert</a>
						</li>
						<li>
							<a href="#" data-toggle="modal" data-target="#journal"><i class="fa fa-envelope"></i> New Journal</a>
						</li>
						{{else}}
						<li>
							<a href="#" ><i class="fa fa-user"></i> Please select a patient</a>
						</li>
						{{/if}}
					</ul>
				</div>
			</div>
		</nav>
	</div>
</template>

<template name="patientPill">
	<span><strong>{{last}}, {{first}}</strong> {{room}}</span>
</template>

<!-- Workaround to sort out logout issue -->
<template name="goodbye">

</template>

<template name="newMeasurement">
	<div class="modal fade" id="measurement" style="display:none;">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true">
						<i class="fa fa-times"></i>
					</button>
					<h3 class="modal-title">New Measurement</h3>
				</div>
				<form class="form">
					<div class="modal-body">
						<strong name="department">Type</strong>&nbsp;
						<select id="measurementType">
							<option data-_id="" value="">Select...</option>
							{{#each units}}
							<option data-_id="{{_id}}" value="{{type}}">{{name}}</option>
							{{/each}}
						</select>
						<div >
							<table class="table measures">
								<tbody>
									{{#each measures}}
									<tr>
										<td>{{preText}}&nbsp;</td>
										<td>
										<input class="measure" type="{{type}}" step="{{step}}" min="{{min}}" max="{{max}}" placeholder="{{unit}}" value="" {{required}}>
										</td>
										<td>{{unit}}&nbsp;</td>
									</tr>
									{{/each}}
								</tbody>
							</table>
						</div>
					</div>
					<div class="modal-footer">
						<button type="submit" class="btn btn-block send">
							<strong><i class="fa fa-circle-o river"></i></strong> Save
						</button>

						<button type="button" class="btn btn-block" data-toggle="collapse" data-target=".measureProblemCollapse">
							<strong><i class="fa fa-exclamation alizarin"></i></strong> Problem
						</button>

						<div class="input-group collapse measureProblemCollapse" style="margin-top: 20px;">
							<strong>Select an existing problem:&nbsp;</strong>
							<br>
							<select id="journalProblemSelector" style="width: 100%">
								<option data-problemId="" value="">Select...</option>
								{{#each problems}}
								<option data-problemId="{{_id}}" value="{{subject}}">{{subject}}</option>
								{{/each}}
							</select>
						</div>
					</div>
				</form>
			</div><!-- /.modal-content -->
		</div><!-- /.modal-dialog -->
	</div><!-- /.modal -->
</template>

<template name="newJournal">
	<div class="modal fade" id="journal" style="display:none;">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true">
						<i class="fa fa-times"></i>
					</button>
					<h3 class="modal-title">New Journal</h3>
				</div>
				<form>
					<div class="modal-body">
						<div class="input-group addmessage">
							<strong>Message:&nbsp;</strong>
							<br>
							<textarea id="messageText" class="input input-block-level" maxlength="180">{{messageData.message}}</textarea>
							<p style="text-align: right; color: #555;" id="textCounter"></p>
						</div>
					</div>
					<div class="input-group addmessage">
						<button class="btn btn-default btn-file">
							<i class="fa fa-file-archive-o {{fileSelected}}"></i> File
							<input id="journalFile" type="file">
						</button>
					</div>
					<div class="modal-footer">
						<button type="submit" class="btn btn-block send">
							<strong><i class="fa fa-circle-o river"></i></strong> Save
						</button>

						<button type="button" class="btn btn-block" data-toggle="collapse" data-target=".journalProblemCollapse">
							<strong><i class="fa fa-exclamation alizarin"></i></strong> Problem
						</button>

						<div class="collapse journalProblemCollapse">
							<table class="table">
								<tbody>
									<td>
									<div class="input-group addmessage">
										<strong>Select an existing problem:&nbsp;</strong>
										<br>
										<select id="journalProblemSelector">
											<option data-problemId="" value="">Select...</option>
											{{#each problems}}
											<option data-problemId="{{_id}}" value="{{subject}}">{{subject}}</option>
											{{/each}}
										</select>
									</div></td>
									<td>
									<div class="input-group addmessage">
										<strong>... Or define a new problem:&nbsp;</strong>
										<br>
										<input id="defineProblem" type="text" maxlength="15" pattern="^\b[a-zA-Z]{2,15}\b" />
									</div></td>
								</tbody>
							</table>
						</div>
					</div>
				</form>
			</div><!-- /.modal-content -->
		</div><!-- /.modal-dialog -->
	</div><!-- /.modal -->
</template>

<template name="modals">
	{{#if patientSelected}}
	{{> newMeasurement}}
	{{> newJournal}}
	{{/if}}
</template>

<template name="loading">
	{{#if notReady}}
	<div class="spinner">
		<div class="cube1"></div>
		<div class="cube2"></div>
	</div>
	{{/if}}
</template>

<template name="connectionStatus">
	{{#if connectionLost}}
	{{#AnimateWithVelocity}}
	<div class="navbar-fixed-top fixed" data-animate data-property="opacity, translateY" data-duration="500" data-from-value="0,-200px" data-to-value="1,0">
		<div class="alert alert-error" style="text-align: center;">
			<strong>Connection lost</strong>
		</div>
	</div>
	{{/AnimateWithVelocity}}
	{{/if}}
</template>

<template name="loginform">
	<div class="container">
		<form id="login-form" class="form-signin">
			<h2 class="form-signin-heading">Login</h2>
			<input type="text" class="input-block-level" id="login-username" placeholder="Username" />
			<input type="password" class="input-block-level" id="login-password" placeholder="password" />
			<input type="submit" id="login-button" value="Sign in" class="btn btn-info btn-block" />
			<input id="create-account" value="Create an Account" class="btn btn-info btn-block" style="margin-top: 20px;"/>
		</form>

	</div>
	<div style="margin-left: auto; margin-right: auto; color:gray;">
		<p style="text-align: center;">
			&copy; 2014 - Christian Dallago, Riccardo Buttarelli - Nursing assisstance 101
		</p>
	</div>
</template>

<template name="registrationform">
	<div class="container">
		<form id="register-form" class="form-signin">
			<h2 class="form-signin-heading">Register</h2>
			<input type="text" class="input-block-level" id="account-first" placeholder="{{language.firstname}}" />
			<input type="text" class="input-block-level" id="account-last" placeholder="{{language.lastname}}" />
			<input type="text" class="input-block-level" id="account-username" placeholder="Username" />
			<!-- <input type="email" class="input-block-level" id="account-email" placeholder="email" /> -->
			<input type="password" class="input-block-level" id="account-password" placeholder="Password" />
			<input type="password" class="input-block-level" id="account-password-repeat" placeholder="Password" />
			<input type="password" class="input-block-level" id="admin-password" placeholder="Admin Password" />
			<select name="department" id="account-department" class="form-control input-block-level" style="margin-top: 10px; margin-bottom: 10px;">
				{{#each departments}}
				<option value="{{this}}">{{this}}</option>
				{{/each}}
			</select>
			<input type="submit" id="create-account" value="{{language.createaccount}}" class="btn btn-info btn-block" />
			<input id="account-signin" value="{{language.backtosignin}}" class="btn btn-info btn-block" style="margin-top: 30px;"/>
		</form>
	</div>
	<div style="margin-left: auto; margin-right: auto; color:gray;">
		<p style="text-align: center;">
			&copy; 2014 - Christian Dallago, Riccardo Buttarelli - Nursing assisstance 101
		</p>
	</div>
</template>

<head>
	<title>Nursing</title>
	<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1, maximum-scale=1, user-scalable=0"/>
	<!--320-->
</head>

<template name="body">
	{{> notifications}}
	{{#if currentUser}}
	{{> modals}}
	{{> navigation}}
	{{/if}}
	{{> yield}}
	{{#if currentUser}}
	{{> footer}}
	{{/if}}
</template>

<body>
	{{> notifications}}
	{{#if currentUser}}
	{{> modals}}
	{{> navigation}}
	{{> connectionStatus}}
	{{> footer}}
	{{/if}}
</body>